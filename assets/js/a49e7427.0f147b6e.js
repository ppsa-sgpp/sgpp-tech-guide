"use strict";(self.webpackChunksgpp_tech_guide=self.webpackChunksgpp_tech_guide||[]).push([[9230],{7387:(e,a,s)=>{s.r(a),s.d(a,{assets:()=>t,contentTitle:()=>r,default:()=>p,frontMatter:()=>i,metadata:()=>o,toc:()=>n});const o=JSON.parse('{"id":"building-blocks/sgpp-services/ciclo-vida","title":"Cria\xe7\xe3o de Etapas de Ciclo de Vida de Contas de Custo em \xd3leo","description":"\ud83d\udd0d\ufe0f Local de cria\xe7\xe3o: sgpp-services","source":"@site/docs/building-blocks/sgpp-services/ciclo-vida.md","sourceDirName":"building-blocks/sgpp-services","slug":"/building-blocks/sgpp-services/ciclo-vida","permalink":"/sgpp-tech-guide/docs/building-blocks/sgpp-services/ciclo-vida","draft":false,"unlisted":false,"editUrl":"https://github.com/ppsa-sgpp/sgpp-tech-guide/edit/main/docs/building-blocks/sgpp-services/ciclo-vida.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Servi\xe7os REST","permalink":"/sgpp-tech-guide/docs/building-blocks/ibm-baw/servicos-rest"},"next":{"title":"Cria\xe7\xe3o de planilha a partir de classe POJO","permalink":"/sgpp-tech-guide/docs/building-blocks/sgpp-services/servico_criacao_planilha_classe"}}');var d=s(4848),c=s(8453);const i={},r="Cria\xe7\xe3o de Etapas de Ciclo de Vida de Contas de Custo em \xd3leo",t={},n=[{value:"Etapas de execu\xe7\xe3o",id:"etapas-de-execu\xe7\xe3o",level:2},{value:"1. Criar classe de API REST",id:"1-criar-classe-de-api-rest",level:3},{value:"2. Criar classe de Requisicao (input de dados) da Etapa",id:"2-criar-classe-de-requisicao-input-de-dados-da-etapa",level:3},{value:"3. Criar classe da Etapa",id:"3-criar-classe-da-etapa",level:3},{value:"3.1 Definir o m\xe9todo executar da etapa",id:"31-definir-o-m\xe9todo-executar-da-etapa",level:4},{value:"4. Atualizar a cria\xe7\xe3o do Ciclo de Vida de Contas de Custo em \xd3leo",id:"4-atualizar-a-cria\xe7\xe3o-do-ciclo-de-vida-de-contas-de-custo-em-\xf3leo",level:3},{value:"5. Atualizar o diagrama do estado atual do Ciclo de Vida de Contas de Custo em \xd3leo",id:"5-atualizar-o-diagrama-do-estado-atual-do-ciclo-de-vida-de-contas-de-custo-em-\xf3leo",level:3}];function l(e){const a={br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(a.header,{children:(0,d.jsx)(a.h1,{id:"cria\xe7\xe3o-de-etapas-de-ciclo-de-vida-de-contas-de-custo-em-\xf3leo",children:"Cria\xe7\xe3o de Etapas de Ciclo de Vida de Contas de Custo em \xd3leo"})}),"\n",(0,d.jsxs)(a.p,{children:["\ud83d\udd0d\ufe0f ",(0,d.jsx)(a.strong,{children:"Local de cria\xe7\xe3o:"})," sgpp-services",(0,d.jsx)(a.br,{}),"\n","\u231b\ufe0f ",(0,d.jsx)(a.strong,{children:"Tempo estimado:"})]}),"\n",(0,d.jsx)(a.h2,{id:"etapas-de-execu\xe7\xe3o",children:"Etapas de execu\xe7\xe3o"}),"\n",(0,d.jsx)(a.h3,{id:"1-criar-classe-de-api-rest",children:"1. Criar classe de API REST"}),"\n",(0,d.jsxs)(a.p,{children:["\ud83d\udce6\ufe0f ",(0,d.jsx)(a.strong,{children:"pacote:"})," ",(0,d.jsx)(a.code,{children:"sgpp.services.web.rest"}),(0,d.jsx)(a.br,{}),"\n","\ud83c\udff7\ufe0f ",(0,d.jsx)(a.strong,{children:"nome:"})," deve refletir o nome da etapa. Deve iniciar com a palavra ",(0,d.jsx)(a.code,{children:"Etapa"})," e terminar com a palavra ",(0,d.jsx)(a.code,{children:"Resource"}),(0,d.jsx)(a.br,{}),"\n","\ud83d\udcc4 ",(0,d.jsx)(a.strong,{children:"descri\xe7\xe3o:"})," Classe que exp\xf5e a etapa do ciclo de vida como API REST. deve possuir apenas um m\xe9todo com a seguinte assinatura ",(0,d.jsx)(a.code,{children:"sgpp.services.web.rest.EtapaAdicaoOverheadContaCustoOleoResource.executar(...)"}),". Esse m\xe9todo deve receber todos os par\xe2metros necess\xe1rios para a composi\xe7\xe3o do input da etapa.\nEsse m\xe9todo deve instanciar a classe de ",(0,d.jsx)(a.em,{children:"Requisicao"})," buscar na base quantos dados forem necess\xe1rios para popular essa classe e utilizar o m\xe9todo ",(0,d.jsx)(a.code,{children:"sgpp.services.service.EventStoreClient.addEtapa(EtapaBaseEvent)"})," para adi\xe7\xe3o da etapa na fila de execu\xe7\xe3o."]}),"\n",(0,d.jsx)(a.pre,{children:(0,d.jsx)(a.code,{children:"\ud83d\udca1 considere fazer dos para\xe2metros do m\xe9todo execute o mais resumidos poss\xedveis, lembrando que o estado da aplica\xe7\xe3o pode ser consultado da base de dados, portanto, esses inputs devem ser indentificadores sempre que poss\xedvel\n"})}),"\n",(0,d.jsx)(a.h3,{id:"2-criar-classe-de-requisicao-input-de-dados-da-etapa",children:"2. Criar classe de Requisicao (input de dados) da Etapa"}),"\n",(0,d.jsxs)(a.p,{children:["\ud83d\udce6\ufe0f ",(0,d.jsx)(a.strong,{children:"pacote:"})," ",(0,d.jsx)(a.code,{children:"sgpp.ciclovidacco.etapas."}),"+ nome da etapa em camel case + ",(0,d.jsx)(a.code,{children:"."})," + n\xfamero da vers\xe3o *vide discuss\xe3o a respeito de versionamento\n\ud83c\udff7\ufe0f ",(0,d.jsx)(a.strong,{children:"nome:"})," deve refletir o nome da etapa. Deve iniciar com a palavra terminar com a palavra ",(0,d.jsx)(a.code,{children:"Requisicao"}),(0,d.jsx)(a.br,{}),"\n","\ud83d\udce4\ufe0f ",(0,d.jsx)(a.strong,{children:"ascend\xeancia:"})," deve extender a classe ",(0,d.jsx)(a.code,{children:"sgpp.ciclovidacco.etapas.EtapaRequisicao"}),"\n#\ufe0f\u20e3 ",(0,d.jsx)(a.strong,{children:"anota\xe7\xf5es:"})," deve ser anotada com as seguintes interfaces da biblioteca lombock ",(0,d.jsx)(a.code,{children:"lombok.Data"}),", ",(0,d.jsx)(a.code,{children:"lombok.EqualsAndHashCode(callSuper = false)"})," e ",(0,d.jsx)(a.code,{children:"lombok.ToString"}),"\n\ud83d\udcc4 ",(0,d.jsx)(a.strong,{children:"descri\xe7\xe3o:"})," ",(0,d.jsx)(a.em,{children:"Value Object"})," deve conter todo o estado da regra de neg\xf3cio modelada na etapa. Dentro do c\xf3digo da etapa, dados do estado da aplica\xe7\xe3o n\xe3o devem ser consultados da base (com algumas exce\xe7\xf5es), portanto todos os objetos de valor devem ser definidos com atributos dessa classe\n\u25b6\ufe0f ",(0,d.jsx)(a.strong,{children:"m\xe9todos:"})," deve conter um m\xe9todo que receba par\xe2emtros correspondentes a seus atributos e instancie a classe (n\xe3o um construtor) com a seguinte assintura ",(0,d.jsx)(a.code,{children:"public static"})," + o nome da classe + ",(0,d.jsx)(a.code,{children:"criarEtapa(...)"})]}),"\n",(0,d.jsx)(a.h3,{id:"3-criar-classe-da-etapa",children:"3. Criar classe da Etapa"}),"\n",(0,d.jsxs)(a.p,{children:["\ud83d\udce6\ufe0f ",(0,d.jsx)(a.strong,{children:"pacote:"})," ",(0,d.jsx)(a.code,{children:"sgpp.ciclovidacco.etapas."}),"+ nome da etapa em camel case + ",(0,d.jsx)(a.code,{children:"."})," + n\xfamero da vers\xe3o *vide discuss\xe3o a respeito de versionamento\n\ud83c\udff7\ufe0f ",(0,d.jsx)(a.strong,{children:"nome:"})," deve refletir o nome da etapa.\n\ud83d\udce4\ufe0f ",(0,d.jsx)(a.strong,{children:"ascend\xeancia:"})," deve extender a classe ",(0,d.jsx)(a.code,{children:"sgpp.ciclovidacco.etapas.EtapaImpl"}),"\n\ud83d\udcc4 ",(0,d.jsx)(a.strong,{children:"descri\xe7\xe3o:"})," Clase que cont\xe9m a regra de neg\xf3cio. Deve obedecer \xe0s seguintes regras:"]}),"\n",(0,d.jsxs)(a.ul,{children:["\n",(0,d.jsx)(a.li,{children:"deve ser indepontente: deve-se garantir que mesmo ap\xf3s m\xfaltiplas execu\xe7\xf5es, os m\xe9todos dessa classe sempre alterem o estado da aplica\xe7\xe3o da mesma forma. Ou seja, execu\xe7\xf5es consecutivas devem ser sem efeito."}),"\n",(0,d.jsxs)(a.li,{children:["n\xe3o deve consultar o estado da aplica\xe7\xe3o: todos os dados considerados pelos m\xe9todos dessa classe devem ser recebidos vindos de um objeto do tipo ",(0,d.jsx)(a.em,{children:"Requisicao"})]}),"\n",(0,d.jsxs)(a.li,{children:["deve capturar todas suas exc\xe7\xf5es: deve-se encapsular toda sua excecu\xe7\xe3o em um try-catch que capture ",(0,d.jsx)(a.code,{children:"java.lang.Exception"})," *vide mais a respeito na discuss\xe3o sobre o m\xe9todo executar\n\u25b6\ufe0f ",(0,d.jsx)(a.strong,{children:"m\xe9todos:"})," deve conter quantos m\xe9todos forem necess\xe1rios, mas apenas um p\xfablico com a seguinte assinatura ",(0,d.jsx)(a.code,{children:"public void executar(EtapaRequisicaoImpl etapaRequisicao)"})," *vide mais a respeito na discuss\xe3o sobre o m\xe9todo executar"]}),"\n"]}),"\n",(0,d.jsx)(a.h4,{id:"31-definir-o-m\xe9todo-executar-da-etapa",children:"3.1 Definir o m\xe9todo executar da etapa"}),"\n",(0,d.jsxs)(a.p,{children:["\ud83d\udcc4 ",(0,d.jsx)(a.strong,{children:"descri\xe7\xe3o:"})," O m\xe9todo executar de uma etapa requer considera\xe7\xf5es espec\xedficas. Esse m\xe9todo deve chamar os seguintes m\xe9todos em seu corpo"]}),"\n",(0,d.jsxs)(a.ul,{children:["\n",(0,d.jsxs)(a.li,{children:[(0,d.jsx)(a.code,{children:"sgpp.services.service.EventoPendenteService.addEvent(BaseEvent, EtapaRequisicao)"}),": m\xe9todo chamado para alterar o estado da aplica\xe7\xe3o no final da aplica\xe7\xe3o das regras de neg\xf3cio. Deve passar um objeto populado descendente de ",(0,d.jsx)(a.code,{children:"sgpp.services.common.BaseEvent"})," e o atributo ",(0,d.jsx)(a.code,{children:"etapaRequisica"})," recebido pelo m\xe9todo executar"]}),"\n",(0,d.jsxs)(a.li,{children:[(0,d.jsx)(a.code,{children:"sgpp.ciclovidacco.etapas.EtapaImpl.lancarExcecaoConclusaoEtapa(CicloVidaCcoService, EtapaRequisicaoImpl, Exception)"}),": m\xe9todo chamado no ",(0,d.jsx)(a.code,{children:"catch(Exception e)"})," do m\xe9todo executar. Deve receber uma inst\xe2ncia do Spring Service ",(0,d.jsx)(a.code,{children:"sgpp.services.contacustooleo.ciclovida.CicloVidaCcoService"}),", o atributo ",(0,d.jsx)(a.code,{children:"etapaRequisica"})," recebido pelo m\xe9todo executar e a exce\xe7\xe3o capturada."]}),"\n",(0,d.jsxs)(a.li,{children:[(0,d.jsx)(a.code,{children:"sgpp.services.contacustooleo.ciclovida.CicloVidaCcoService.concluirEtapa(EtapaBaseEvent)"}),": m\xe9todo que deve ser chamado fora do tratamento de exce\xe7\xe3o ao finalizar a etapa. Deve receber o atributo ",(0,d.jsx)(a.code,{children:"etapaRequisica"})," recebido pelo m\xe9todo executar"]}),"\n"]}),"\n",(0,d.jsx)(a.h3,{id:"4-atualizar-a-cria\xe7\xe3o-do-ciclo-de-vida-de-contas-de-custo-em-\xf3leo",children:"4. Atualizar a cria\xe7\xe3o do Ciclo de Vida de Contas de Custo em \xd3leo"}),"\n",(0,d.jsxs)(a.p,{children:["\u25b6\ufe0f ",(0,d.jsx)(a.strong,{children:"m\xe9todos:"})," deve ser alterado o m\xe9todo ",(0,d.jsx)(a.code,{children:"sgpp.services.contacustooleo.ciclovida.CicloVidaCcoService.createCicloVidaDefault(FaseRemessaEnum, String, boolean iniciadoEmFaseRecursiva)"})," considerando em que processo a etapa ser\xe1 ativada. Utiliza-se o m\xe9todo ",(0,d.jsx)(a.code,{children:"sgpp.services.contacustooleo.ciclovida.CicloVidaCcoEntity.adicionarEtapaNoFim(CicloVidaCcoEtapaEnum, CicloVidaCcoEtapaVersaoLogicaEnum, CicloVidaCcoEtapaVersaoRequisicaoEnum)"}),"para adicionar a etapa aos p\u0155oximos ciclos de vida gerados. Deve-se tamb\xe9m atentar para a necessidade de criar um item na enumera\xe7\xe3o ",(0,d.jsx)(a.code,{children:"sgpp.services.contacustooleo.ciclovida.CicloVidaCcoEtapaEnum"}),"que represente a etapa criada"]}),"\n",(0,d.jsx)(a.h3,{id:"5-atualizar-o-diagrama-do-estado-atual-do-ciclo-de-vida-de-contas-de-custo-em-\xf3leo",children:"5. Atualizar o diagrama do estado atual do Ciclo de Vida de Contas de Custo em \xd3leo"}),"\n",(0,d.jsxs)(a.p,{children:["\ud83d\udcc4 ",(0,d.jsx)(a.strong,{children:"descri\xe7\xe3o:"})," Deve-se atualizar o diagrama e atualizar a imagem abaixo nesse documento\n",(0,d.jsx)(a.img,{alt:"Etapas",src:s(2963).A+"",width:"1639",height:"1336"})]})]})}function p(e={}){const{wrapper:a}={...(0,c.R)(),...e.components};return a?(0,d.jsx)(a,{...e,children:(0,d.jsx)(l,{...e})}):l(e)}},2963:(e,a,s)=>{s.d(a,{A:()=>o});const o=s.p+"assets/images/etapas_ciclo_vida_v4-0ea858a07ee38dfa15c0333a070aac6d.png"},8453:(e,a,s)=>{s.d(a,{R:()=>i,x:()=>r});var o=s(6540);const d={},c=o.createContext(d);function i(e){const a=o.useContext(c);return o.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function r(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:i(e.components),o.createElement(c.Provider,{value:a},e.children)}}}]);