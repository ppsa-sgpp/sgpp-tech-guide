"use strict";(self.webpackChunksgpp_tech_guide=self.webpackChunksgpp_tech_guide||[]).push([[4984],{1911:(e,s,r)=>{r.d(s,{R:()=>n,x:()=>d});var a=r(9729);const o={},i=a.createContext(o);function n(e){const s=a.useContext(i);return a.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function d(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:n(e.components),a.createElement(i.Provider,{value:s},e.children)}},8011:(e,s,r)=>{r.r(s),r.d(s,{assets:()=>c,contentTitle:()=>d,default:()=>u,frontMatter:()=>n,metadata:()=>a,toc:()=>t});const a=JSON.parse('{"id":"adrs/observabilidade","title":"ADR-019 \u2013 Observabilidade de logs de microsservi\xe7os com Grafana","description":"- Status: Accepted","source":"@site/docs/adrs/0020-observabilidade.md","sourceDirName":"adrs","slug":"/adrs/observabilidade","permalink":"/sgpp-tech-guide/docs/adrs/observabilidade","draft":false,"unlisted":false,"editUrl":"https://github.com/ppsa-sgpp/sgpp-tech-guide/edit/main/docs/adrs/0020-observabilidade.md","tags":[],"version":"current","sidebarPosition":20,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"ADR-018 \u2013 Ciclo de Vida da CCO (auditoria, versionamento e reexecu\xe7\xe3o)","permalink":"/sgpp-tech-guide/docs/adrs/ciclo-vida-ccos"},"next":{"title":"ADR-020 \u2013 Notifica\xe7\xf5es em tempo real (WebSocket Manager + WebSocket Hub para BAW)","permalink":"/sgpp-tech-guide/docs/adrs/notificacoes-tempo-real"}}');var o=r(5813),i=r(1911);const n={},d="ADR-019 \u2013 Observabilidade de logs de microsservi\xe7os com Grafana",c={},t=[{value:"Contexto",id:"contexto",level:2},{value:"Decis\xe3o",id:"decis\xe3o",level:2},{value:"Consequ\xeancias",id:"consequ\xeancias",level:2},{value:"Rela\xe7\xf5es",id:"rela\xe7\xf5es",level:2}];function l(e){const s={br:"br",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.header,{children:(0,o.jsx)(s.h1,{id:"adr-019--observabilidade-de-logs-de-microsservi\xe7os-com-grafana",children:"ADR-019 \u2013 Observabilidade de logs de microsservi\xe7os com Grafana"})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Status:"})," Accepted"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Data:"})," 2025-09-01"]}),"\n"]}),"\n",(0,o.jsx)(s.h2,{id:"contexto",children:"Contexto"}),"\n",(0,o.jsxs)(s.p,{children:["Os microsservi\xe7os do SGPP rodam em ",(0,o.jsx)(s.strong,{children:"Kubernetes"})," (ver ADR-009) e possuem natureza ",(0,o.jsx)(s.strong,{children:"ef\xeamera"})," \u2014 pods podem ser recriados a qualquer momento.",(0,o.jsx)(s.br,{}),"\n","A perda de logs locais dificulta auditoria, depura\xe7\xe3o de falhas e rastreamento de execu\xe7\xf5es.",(0,o.jsx)(s.br,{}),"\n","\xc9 necess\xe1rio centralizar os logs de execu\xe7\xe3o em uma solu\xe7\xe3o persistente e acess\xedvel ao time, com capacidade de busca e visualiza\xe7\xe3o em tempo real."]}),"\n",(0,o.jsx)(s.h2,{id:"decis\xe3o",children:"Decis\xe3o"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Adotar o ",(0,o.jsx)(s.strong,{children:"Grafana"})," como plataforma de observabilidade para captura e visualiza\xe7\xe3o de logs."]}),"\n",(0,o.jsx)(s.li,{children:"Configurar forwarders de log nos containers/pods para enviar sa\xeddas de console (stdout/stderr) para o backend de logs (Grafana Loki)."}),"\n",(0,o.jsxs)(s.li,{children:["Disponibilizar dashboards no Grafana que permitam:","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"Buscar logs por microsservi\xe7o, pod, namespace e correla\xe7\xe3o de request."}),"\n",(0,o.jsx)(s.li,{children:"Acompanhar em tempo real execu\xe7\xf5es de processos e handlers."}),"\n",(0,o.jsx)(s.li,{children:"Correlacionar logs entre servi\xe7os distintos por traceId."}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(s.li,{children:"Integrar a solu\xe7\xe3o com o pipeline de CI/CD para validar gera\xe7\xe3o de logs estruturados."}),"\n"]}),"\n",(0,o.jsx)(s.h2,{id:"consequ\xeancias",children:"Consequ\xeancias"}),"\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.strong,{children:"Positivas"})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Logs de microsservi\xe7os ef\xeameros ficam ",(0,o.jsx)(s.strong,{children:"centralizados e persistentes"}),"."]}),"\n",(0,o.jsxs)(s.li,{children:["Facilita ",(0,o.jsx)(s.strong,{children:"depura\xe7\xe3o"})," de falhas e rastreabilidade de requests distribu\xeddos."]}),"\n",(0,o.jsxs)(s.li,{children:["Permite ",(0,o.jsx)(s.strong,{children:"monitoramento proativo"})," com alertas configurados em cima dos logs."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Interface unificada"})," no Grafana, j\xe1 utilizado para m\xe9tricas."]}),"\n"]}),"\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.strong,{children:"Negativas"})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Exige ",(0,o.jsx)(s.strong,{children:"configura\xe7\xe3o e opera\xe7\xe3o"})," de infraestrutura adicional (Grafana + Loki)."]}),"\n",(0,o.jsxs)(s.li,{children:["Introduz ",(0,o.jsx)(s.strong,{children:"sobrecarga de rede e armazenamento"}),", pois todos os logs s\xe3o centralizados."]}),"\n",(0,o.jsxs)(s.li,{children:["Necessita de ",(0,o.jsx)(s.strong,{children:"governan\xe7a de reten\xe7\xe3o"}),", para n\xe3o acumular custos com logs hist\xf3ricos."]}),"\n"]}),"\n",(0,o.jsx)(s.h2,{id:"rela\xe7\xf5es",children:"Rela\xe7\xf5es"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"ADR-009 \u2013 Runtime em IBM Cloud Kubernetes Service"}),": define o ambiente onde os logs s\xe3o coletados."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"ADR-007 \u2013 Kafka"}),": consumidores/produtores tamb\xe9m precisam expor logs estruturados para an\xe1lise no Grafana."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsxs)(s.strong,{children:["ADR-014 \u2013 Consolida\xe7\xe3o no ",(0,o.jsx)(s.code,{children:"sgpp-services"})]}),": logs desse servi\xe7o central s\xe3o cr\xedticos e passam a ser monitorados no Grafana."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"ADR-017 \u2013 Ciclo de Vida da CCO"}),": execu\xe7\xe3o de etapas gera eventos e logs que precisam ser rastreados para auditoria."]}),"\n"]})]})}function u(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,o.jsx)(s,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}}}]);