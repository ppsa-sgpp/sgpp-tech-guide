"use strict";(self.webpackChunksgpp_tech_guide=self.webpackChunksgpp_tech_guide||[]).push([[2947],{1911:(e,s,n)=>{n.d(s,{R:()=>i,x:()=>t});var r=n(9729);const o={},a=r.createContext(o);function i(e){const s=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function t(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),r.createElement(a.Provider,{value:s},e.children)}},2573:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>t,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"adr/data-mart-etl","title":"ADR-017 \u2013 Data Mart em DB2 e processos ETL (db2-etl)","description":"- Status: Accepted","source":"@site/docs/adr/0018-data-mart-etl.md","sourceDirName":"adr","slug":"/adr/data-mart-etl","permalink":"/sgpp-tech-guide/docs/adr/data-mart-etl","draft":false,"unlisted":false,"editUrl":"https://github.com/ppsa-sgpp/sgpp-tech-guide/edit/main/docs/adr/0018-data-mart-etl.md","tags":[],"version":"current","sidebarPosition":18,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"ADR-016 \u2013 Integra\xe7\xe3o com IBM Cloud Object Store para documentos","permalink":"/sgpp-tech-guide/docs/adr/repositorio-documentos"},"next":{"title":"ADR-018 \u2013 Ciclo de Vida da CCO (auditoria, versionamento e reexecu\xe7\xe3o)","permalink":"/sgpp-tech-guide/docs/adr/ciclo-vida-ccos"}}');var o=n(5813),a=n(1911);const i={},t="ADR-017 \u2013 Data Mart em DB2 e processos ETL (db2-etl)",d={},l=[{value:"Contexto",id:"contexto",level:2},{value:"Decis\xe3o",id:"decis\xe3o",level:2},{value:"Consequ\xeancias",id:"consequ\xeancias",level:2},{value:"Operacional",id:"operacional",level:2},{value:"Rela\xe7\xf5es",id:"rela\xe7\xf5es",level:2}];function c(e){const s={br:"br",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.header,{children:(0,o.jsxs)(s.h1,{id:"adr-017--data-mart-em-db2-e-processos-etl-db2-etl",children:["ADR-017 \u2013 Data Mart em DB2 e processos ETL (",(0,o.jsx)(s.code,{children:"db2-etl"}),")"]})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Status:"})," Accepted"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Data:"})," 2023-09-01"]}),"\n"]}),"\n",(0,o.jsx)(s.h2,{id:"contexto",children:"Contexto"}),"\n",(0,o.jsxs)(s.p,{children:["A PPSA exige que os dados operacionais do SGPP estejam dispon\xedveis em ",(0,o.jsx)(s.strong,{children:"DB2"})," para consumo por ",(0,o.jsx)(s.strong,{children:"Power BI"}),", como condi\xe7\xe3o de renegocia\xe7\xe3o contratual.",(0,o.jsx)(s.br,{}),"\n","Os dados operacionais residem nas ",(0,o.jsx)(s.strong,{children:"proje\xe7\xf5es de leitura no MongoDB"})," (ver ADR-008 e ADR-006). \xc9 necess\xe1rio replic\xe1-los para um ",(0,o.jsx)(s.strong,{children:"Data Mart em DB2"}),", em modelos adequados a an\xe1lise e relat\xf3rios."]}),"\n",(0,o.jsx)(s.h2,{id:"decis\xe3o",children:"Decis\xe3o"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Criar o servi\xe7o ",(0,o.jsx)(s.strong,{children:(0,o.jsx)(s.code,{children:"db2-etl"})})," respons\xe1vel por ",(0,o.jsx)(s.strong,{children:"extrair"})," dados das proje\xe7\xf5es no MongoDB, ",(0,o.jsx)(s.strong,{children:"transformar"})," para modelos relacionais (tabelas fato/dimens\xe3o ou tabelas normalizadas por dom\xednio) e ",(0,o.jsx)(s.strong,{children:"carregar"})," no ",(0,o.jsx)(s.strong,{children:"DB2"}),"."]}),"\n",(0,o.jsxs)(s.li,{children:["O ",(0,o.jsx)(s.code,{children:"db2-etl"})," dever\xe1 ser codificado em ",(0,o.jsx)(s.strong,{children:"Python"})," pois esse oferece bibliotecas maduras para ETL."]}),"\n",(0,o.jsxs)(s.li,{children:["Definir execu\xe7\xe3o ",(0,o.jsx)(s.strong,{children:"agendada"})," (ex.: janelas di\xe1rias D+1) e, quando aplic\xe1vel, ",(0,o.jsx)(s.strong,{children:"incremental"})," por carimbo de tempo/vers\xe3o."]}),"\n",(0,o.jsxs)(s.li,{children:["Implementar ",(0,o.jsx)(s.strong,{children:"mapeamentos de schema"})," expl\xedcitos (contratos de ETL) versionados em reposit\xf3rio."]}),"\n",(0,o.jsxs)(s.li,{children:["Garantir ",(0,o.jsx)(s.strong,{children:"idempot\xeancia"})," e ",(0,o.jsx)(s.strong,{children:"reprocessamento"})," (marcos de carga, controle por lote, chaves de de-duplica\xe7\xe3o)."]}),"\n",(0,o.jsxs)(s.li,{children:["Registrar ",(0,o.jsx)(s.strong,{children:"linhagem e auditoria"})," de ETL (timestamp de extra\xe7\xe3o, origem, vers\xe3o do mapeamento)."]}),"\n",(0,o.jsxs)(s.li,{children:["Publicar ",(0,o.jsx)(s.strong,{children:"cat\xe1logo de tabelas"})," e conven\xe7\xf5es (prefixos, sufixos, chaves, \xedndices) para uso do Power BI."]}),"\n"]}),"\n",(0,o.jsx)(s.h2,{id:"consequ\xeancias",children:"Consequ\xeancias"}),"\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.strong,{children:"Positivas"})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Atende requisito contratual da PPSA para ",(0,o.jsx)(s.strong,{children:"consumo em DB2/Power BI"}),"."]}),"\n",(0,o.jsxs)(s.li,{children:["Isola a ",(0,o.jsx)(s.strong,{children:"camada anal\xedtica"})," do banco operacional (Mongo), preservando performance de leitura do SGPP."]}),"\n",(0,o.jsxs)(s.li,{children:["Permite ",(0,o.jsx)(s.strong,{children:"modelagem anal\xedtica apropriada"})," (joins, agrega\xe7\xf5es, SCD quando necess\xe1rio)."]}),"\n"]}),"\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.strong,{children:"Negativas"})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Introduz ",(0,o.jsx)(s.strong,{children:"lat\xeancia"})," entre opera\xe7\xe3o e an\xe1lise (ex.: D+1)."]}),"\n",(0,o.jsxs)(s.li,{children:["Requer ",(0,o.jsx)(s.strong,{children:"governan\xe7a de mapeamentos"})," e manuten\xe7\xe3o quando o modelo operacional evolui."]}),"\n",(0,o.jsxs)(s.li,{children:["Aumenta a ",(0,o.jsx)(s.strong,{children:"superf\xedcie operacional"})," (agendamentos, falhas de carga, monitora\xe7\xe3o)."]}),"\n"]}),"\n",(0,o.jsx)(s.h2,{id:"operacional",children:"Operacional"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["O ",(0,o.jsx)(s.code,{children:"db2-etl"})," roda em ",(0,o.jsx)(s.strong,{children:"Kubernetes"})," (ver ADR-009) e exp\xf5e m\xe9tricas/logs (ver ADR-017)."]}),"\n",(0,o.jsxs)(s.li,{children:["Estrat\xe9gias de carga: ",(0,o.jsx)(s.strong,{children:"full"})," inicial e ",(0,o.jsx)(s.strong,{children:"incremental"})," por delta (timestamp/vers\xe3o de evento)."]}),"\n"]}),"\n",(0,o.jsx)(s.h2,{id:"rela\xe7\xf5es",children:"Rela\xe7\xf5es"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"ADR-001 \u2013 Event Sourcing + CQRS"})," e ",(0,o.jsx)(s.strong,{children:"ADR-006 \u2013 Separa\xe7\xe3o dos modelos"}),": fonte prim\xe1ria s\xe3o as ",(0,o.jsx)(s.strong,{children:"proje\xe7\xf5es de leitura"}),"."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"ADR-008 \u2013 MongoDB"}),": origem operacional do ETL."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"ADR-009 \u2013 Runtime em IBM Cloud Kubernetes Service"}),": execu\xe7\xe3o do ",(0,o.jsx)(s.code,{children:"db2-etl"}),"."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"ADR-017 \u2013 Observabilidade"}),": monitora\xe7\xe3o de jobs, throughput, falhas e SLAs de carga."]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,a.R)(),...e.components};return s?(0,o.jsx)(s,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}}}]);