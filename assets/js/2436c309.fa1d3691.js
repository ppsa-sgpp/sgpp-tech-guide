"use strict";(self.webpackChunksgpp_tech_guide=self.webpackChunksgpp_tech_guide||[]).push([[9057],{1911:(e,s,n)=>{n.d(s,{R:()=>a,x:()=>c});var r=n(9729);const o={},i=r.createContext(o);function a(e){const s=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),r.createElement(i.Provider,{value:s},e.children)}},8687:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>t,contentTitle:()=>c,default:()=>p,frontMatter:()=>a,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"adr/notificacoes-tempo-real","title":"ADR-020 \u2013 Notifica\xe7\xf5es em tempo real (WebSocket Manager + WebSocket Hub para BAW)","description":"- Status: Accepted","source":"@site/docs/adr/0021-notificacoes-tempo-real.md","sourceDirName":"adr","slug":"/adr/notificacoes-tempo-real","permalink":"/sgpp-tech-guide/docs/adr/notificacoes-tempo-real","draft":false,"unlisted":false,"editUrl":"https://github.com/ppsa-sgpp/sgpp-tech-guide/edit/main/docs/adr/0021-notificacoes-tempo-real.md","tags":[],"version":"current","sidebarPosition":21,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"ADR-019 \u2013 Observabilidade de logs de microsservi\xe7os com Grafana","permalink":"/sgpp-tech-guide/docs/adr/observabilidade"},"next":{"title":"ADR-021 \u2013 C4 + Structurizr (e BPMN.io) como padr\xe3o de documenta\xe7\xe3o","permalink":"/sgpp-tech-guide/docs/adr/c4-structurizr-bpmn"}}');var o=n(5813),i=n(1911);const a={},c="ADR-020 \u2013 Notifica\xe7\xf5es em tempo real (WebSocket Manager + WebSocket Hub para BAW)",t={},d=[{value:"Contexto",id:"contexto",level:2},{value:"Decis\xe3o",id:"decis\xe3o",level:2},{value:"Consequ\xeancias",id:"consequ\xeancias",level:2},{value:"Operacional",id:"operacional",level:2},{value:"Rela\xe7\xf5es",id:"rela\xe7\xf5es",level:2}];function l(e){const s={br:"br",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.header,{children:(0,o.jsx)(s.h1,{id:"adr-020--notifica\xe7\xf5es-em-tempo-real-websocket-manager--websocket-hub-para-baw",children:"ADR-020 \u2013 Notifica\xe7\xf5es em tempo real (WebSocket Manager + WebSocket Hub para BAW)"})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Status:"})," Accepted"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Data:"})," 2025-03-01"]}),"\n"]}),"\n",(0,o.jsx)(s.h2,{id:"contexto",children:"Contexto"}),"\n",(0,o.jsxs)(s.p,{children:["A melhoria de Gerenciamento de Ballots do SGPP requer ",(0,o.jsx)(s.strong,{children:"comunica\xe7\xe3o ass\xedncrona entre Coaches do IBM BAW"})," no navegador do usu\xe1rio, para atualizar telas e coordenar intera\xe7\xf5es sem polling.",(0,o.jsx)(s.br,{}),"\n","O BAW precisa de ",(0,o.jsx)(s.strong,{children:"ajustes de configura\xe7\xe3o"})," para permitir ",(0,o.jsx)(s.strong,{children:"conex\xf5es WebSocket diretas"})," a partir do navegador.",(0,o.jsx)(s.br,{}),"\n","Para orquestrar essa comunica\xe7\xe3o, o SGPP adota um servi\xe7o dedicado e um componente de UI integrado aos Coaches."]}),"\n",(0,o.jsx)(s.h2,{id:"decis\xe3o",children:"Decis\xe3o"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Criar o servi\xe7o ",(0,o.jsx)(s.strong,{children:(0,o.jsx)(s.code,{children:"sgpp-websocket-manager"})}),", respons\xe1vel por:","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Gerenciar ",(0,o.jsx)(s.strong,{children:"inscri\xe7\xe3o de clientes"})," (navegadores) em ",(0,o.jsx)(s.strong,{children:"t\xf3picos"}),"."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Receber"})," e ",(0,o.jsx)(s.strong,{children:"propagar"})," mensagens entre clientes inscritos em cada t\xf3pico."]}),"\n",(0,o.jsx)(s.li,{children:"Expor endpoints WebSocket (e, quando necess\xe1rio, HTTP) para publica\xe7\xe3o/assinatura."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Criar o ",(0,o.jsx)(s.strong,{children:"WebSocket Hub"}),", um ",(0,o.jsx)(s.strong,{children:"Coach View"})," que:","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Propaga mensagens"})," recebidas utilizando a ",(0,o.jsx)(s.strong,{children:"infraestrutura Dojo"})," de eventos dos Coaches."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Recebe eventos"})," do mesmo barramento Dojo e ",(0,o.jsx)(s.strong,{children:"envia"})," ao ",(0,o.jsx)(s.code,{children:"sgpp-websocket-manager"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["Padronizar a ",(0,o.jsx)(s.strong,{children:"nomenclatura das mensagens"}),":","\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.code,{children:"WS_IN_<SIGLA_DO_PROCESSO>_<NOME>"}),": mensagens ",(0,o.jsx)(s.strong,{children:"originadas nos Coaches"})," (via Dojo) que ",(0,o.jsx)(s.strong,{children:"devem ir"})," ao ",(0,o.jsx)(s.code,{children:"sgpp-websocket-manager"}),"."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.code,{children:"WS_OUT_<SIGLA_DO_PROCESSO>_<NOME>"}),": mensagens ",(0,o.jsxs)(s.strong,{children:["vindo do ",(0,o.jsx)(s.code,{children:"sgpp-websocket-manager"})]})," que ",(0,o.jsx)(s.strong,{children:"chegam"})," ao WebSocket Hub (Coach View) e s\xe3o propagadas no Dojo."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(s.h2,{id:"consequ\xeancias",children:"Consequ\xeancias"}),"\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.strong,{children:"Positivas"})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Habilita ",(0,o.jsx)(s.strong,{children:"atualiza\xe7\xf5es em tempo real"})," entre Coaches sem polling, melhorando UX e responsividade."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Desacopla"})," frontends (Coaches) via t\xf3picos, reduzindo depend\xeancias diretas entre telas e processos."]}),"\n",(0,o.jsxs)(s.li,{children:["Centraliza a ",(0,o.jsx)(s.strong,{children:"governan\xe7a de canais"})," e regras de roteamento em um \xfanico servi\xe7o (",(0,o.jsx)(s.code,{children:"sgpp-websocket-manager"}),")."]}),"\n"]}),"\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.strong,{children:"Negativas"})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Exige ",(0,o.jsx)(s.strong,{children:"configura\xe7\xe3o espec\xedfica do BAW"})," e de infraestrutura para permitir WebSockets a partir do navegador."]}),"\n",(0,o.jsxs)(s.li,{children:["Introduz ",(0,o.jsx)(s.strong,{children:"complexidade operacional"})," (escalabilidade de conex\xf5es, autentica\xe7\xe3o, isolamento por t\xf3pico/sess\xe3o)."]}),"\n",(0,o.jsxs)(s.li,{children:["Necessita de ",(0,o.jsx)(s.strong,{children:"boas pr\xe1ticas de seguran\xe7a"})," (autoriza\xe7\xe3o por t\xf3pico, expira\xe7\xe3o de sess\xf5es, limita\xe7\xe3o de fan-out)."]}),"\n"]}),"\n",(0,o.jsx)(s.h2,{id:"operacional",children:"Operacional"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.code,{children:"sgpp-websocket-manager"})," executa em ",(0,o.jsx)(s.strong,{children:"Kubernetes"})," (ver ADR-009), com r\xe9plicas e verifica\xe7\xe3o de sa\xfade."]}),"\n",(0,o.jsxs)(s.li,{children:["O WebSocket Hub (Coach View) embute ",(0,o.jsx)(s.strong,{children:"hooks Dojo"})," para publicar/assinar eventos."]}),"\n",(0,o.jsxs)(s.li,{children:["T\xf3picos usam conven\xe7\xe3o ",(0,o.jsx)(s.code,{children:"<SIGLA_DO_PROCESSO>"})," e escopos por ",(0,o.jsx)(s.strong,{children:"inst\xe2ncia de processo"})," quando necess\xe1rio."]}),"\n"]}),"\n",(0,o.jsx)(s.h2,{id:"rela\xe7\xf5es",children:"Rela\xe7\xf5es"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"ADR-002 \u2013 Orquestra\xe7\xe3o no BAW"}),": Coaches integram o WebSocket Hub para eventos em tempo real."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"ADR-007 \u2013 Kafka"}),": opcionalmente, eventos de dom\xednio podem disparar notifica\xe7\xf5es via WebSocket (bridge)."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsxs)(s.strong,{children:["ADR-014 \u2013 Consolida\xe7\xe3o no ",(0,o.jsx)(s.code,{children:"sgpp-services"})]}),": servi\xe7os do dom\xednio podem publicar mensagens para clientes via ",(0,o.jsx)(s.code,{children:"sgpp-websocket-manager"}),"."]}),"\n"]})]})}function p(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,o.jsx)(s,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}}}]);