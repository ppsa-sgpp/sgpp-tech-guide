"use strict";(self.webpackChunksgpp_tech_guide=self.webpackChunksgpp_tech_guide||[]).push([[7183],{1911:(e,s,n)=>{n.d(s,{R:()=>d,x:()=>i});var o=n(9729);const a={},r=o.createContext(a);function d(e){const s=o.useContext(r);return o.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:d(e.components),o.createElement(r.Provider,{value:s},e.children)}},9403:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>t,contentTitle:()=>i,default:()=>p,frontMatter:()=>d,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"adrs/separacao-modelos-dados","title":"ADR-005 \u2013 Separa\xe7\xe3o dos modelos de dados (Write/Event Log vs Read/Entidades)","description":"- Status: Accepted","source":"@site/docs/adrs/0006-separacao-modelos-dados.md","sourceDirName":"adrs","slug":"/adrs/separacao-modelos-dados","permalink":"/sgpp-tech-guide/docs/adrs/separacao-modelos-dados","draft":false,"unlisted":false,"editUrl":"https://github.com/ppsa-sgpp/sgpp-tech-guide/edit/main/docs/adrs/0006-separacao-modelos-dados.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"ADR-004 \u2013 Identidade e SSO via SAML com Azure AD","permalink":"/sgpp-tech-guide/docs/adrs/identidade-sso-saml"},"next":{"title":"ADR-006 \u2013 Mensageria e publica\xe7\xe3o de eventos (Kafka / pub-sub)","permalink":"/sgpp-tech-guide/docs/adrs/mensageria"}}');var a=n(5813),r=n(1911);const d={},i="ADR-005 \u2013 Separa\xe7\xe3o dos modelos de dados (Write/Event Log vs Read/Entidades)",t={},l=[{value:"Contexto",id:"contexto",level:2},{value:"Decis\xe3o",id:"decis\xe3o",level:2},{value:"Consequ\xeancias",id:"consequ\xeancias",level:2},{value:"Rela\xe7\xf5es",id:"rela\xe7\xf5es",level:2}];function c(e){const s={br:"br",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.header,{children:(0,a.jsx)(s.h1,{id:"adr-005--separa\xe7\xe3o-dos-modelos-de-dados-writeevent-log-vs-readentidades",children:"ADR-005 \u2013 Separa\xe7\xe3o dos modelos de dados (Write/Event Log vs Read/Entidades)"})}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Status:"})," Accepted"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Data:"})," 2019-09-05"]}),"\n"]}),"\n",(0,a.jsx)(s.h2,{id:"contexto",children:"Contexto"}),"\n",(0,a.jsxs)(s.p,{children:["O padr\xe3o Event Sourcing adotado no ADR-001 registra todos os eventos no ",(0,a.jsx)(s.strong,{children:"Event Log"}),", mas consultas diretamente sobre esse log seriam ineficientes para o uso di\xe1rio.",(0,a.jsx)(s.br,{}),"\n","Era necess\xe1rio adotar uma estrat\xe9gia de ",(0,a.jsx)(s.strong,{children:"separa\xe7\xe3o entre o modelo de escrita (imut\xe1vel, orientado a eventos)"})," e o ",(0,a.jsx)(s.strong,{children:"modelo de leitura (materializado, otimizado para consulta)"}),"."]}),"\n",(0,a.jsx)(s.h2,{id:"decis\xe3o",children:"Decis\xe3o"}),"\n",(0,a.jsxs)(s.p,{children:["Implementar ",(0,a.jsx)(s.strong,{children:"CQRS na pr\xe1tica"}),":"]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["O ",(0,a.jsx)(s.strong,{children:"Event Store"})," recebe comandos e grava apenas eventos no Event Log."]}),"\n",(0,a.jsxs)(s.li,{children:["Handlers ass\xedncronos consomem os eventos via Kafka e atualizam ",(0,a.jsx)(s.strong,{children:"proje\xe7\xf5es de leitura"})," (base de entidades)."]}),"\n",(0,a.jsxs)(s.li,{children:["Toda a leitura do sistema \xe9 feita a partir das ",(0,a.jsx)(s.strong,{children:"proje\xe7\xf5es"}),"."]}),"\n",(0,a.jsxs)(s.li,{children:["O Event Log permanece como ",(0,a.jsx)(s.strong,{children:"fonte de verdade"})," para versionamento e auditoria."]}),"\n"]}),"\n",(0,a.jsx)(s.h2,{id:"consequ\xeancias",children:"Consequ\xeancias"}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Positivas"})}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"Consultas r\xe1pidas e flex\xedveis sobre entidades de neg\xf3cio."}),"\n",(0,a.jsx)(s.li,{children:"Event Log protegido de acessos diretos, reservado para auditoria e replay."}),"\n",(0,a.jsx)(s.li,{children:"Arquitetura escal\xe1vel, pois proje\xe7\xf5es podem ser replicadas ou particionadas."}),"\n"]}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Negativas"})}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["Necessidade de manter ",(0,a.jsx)(s.strong,{children:"mecanismo de sincroniza\xe7\xe3o"})," entre Event Log e proje\xe7\xf5es."]}),"\n",(0,a.jsxs)(s.li,{children:["Complexidade extra para lidar com ",(0,a.jsx)(s.strong,{children:"consist\xeancia eventual"}),"."]}),"\n",(0,a.jsx)(s.li,{children:"Opera\xe7\xf5es de recupera\xe7\xe3o exigem lidar com dois modelos distintos."}),"\n"]}),"\n",(0,a.jsx)(s.h2,{id:"rela\xe7\xf5es",children:"Rela\xe7\xf5es"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"ADR-001 \u2013 Estilo arquitetural: Event Sourcing + CQRS"}),": decis\xe3o de alto n\xedvel que motivou a separa\xe7\xe3o."]}),"\n",(0,a.jsxs)(s.li,{children:["Este ADR detalha ",(0,a.jsx)(s.strong,{children:"como"})," a separa\xe7\xe3o se materializa nos servi\xe7os e reposit\xf3rios de dados."]}),"\n"]})]})}function p(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}}}]);