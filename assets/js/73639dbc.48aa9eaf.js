"use strict";(self.webpackChunksgpp_tech_guide=self.webpackChunksgpp_tech_guide||[]).push([[2918],{5453:(e,a,o)=>{o.r(a),o.d(a,{assets:()=>l,contentTitle:()=>t,default:()=>p,frontMatter:()=>n,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"building-blocks/sgpp-services/servico_criacao_planilha_classe","title":"Cria\xe7\xe3o de planilha a partir de classe POJO","description":"\ud83d\udd0d\ufe0f Local de cria\xe7\xe3o: sgpp-services","source":"@site/docs/building-blocks/sgpp-services/servico_criacao_planilha_classe.md","sourceDirName":"building-blocks/sgpp-services","slug":"/building-blocks/sgpp-services/servico_criacao_planilha_classe","permalink":"/sgpp-tech-guide/docs/building-blocks/sgpp-services/servico_criacao_planilha_classe","draft":false,"unlisted":false,"editUrl":"https://github.com/ppsa-sgpp/sgpp-tech-guide/edit/main/docs/building-blocks/sgpp-services/servico_criacao_planilha_classe.md","tags":[],"version":"current","frontMatter":{"title":"Cria\xe7\xe3o de planilha a partir de classe POJO"},"sidebar":"tutorialSidebar","previous":{"title":"Servi\xe7os REST","permalink":"/sgpp-tech-guide/docs/building-blocks/ibm-baw/servicos-rest"},"next":{"title":"Arquitetura","permalink":"/sgpp-tech-guide/docs/confidential/arquitetura/"}}');var s=o(4848),i=o(8453);const n={title:"Cria\xe7\xe3o de planilha a partir de classe POJO"},t=void 0,l={},c=[{value:"Etapas de execu\xe7\xe3o cria\xe7\xe3o",id:"etapas-de-execu\xe7\xe3o-cria\xe7\xe3o",level:2},{value:"Anota\xe7\xf5es",id:"anota\xe7\xf5es",level:3},{value:"M\xe9todo de cria\xe7\xe3o de planilha",id:"m\xe9todo-de-cria\xe7\xe3o-de-planilha",level:3},{value:"Teste automatizado",id:"teste-automatizado",level:2}];function d(e){const a={br:"br",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(a.p,{children:["\ud83d\udd0d\ufe0f ",(0,s.jsx)(a.strong,{children:"Local de cria\xe7\xe3o:"})," sgpp-services",(0,s.jsx)(a.br,{}),"\n","\u231b\ufe0f ",(0,s.jsx)(a.strong,{children:"Tempo estimado:"})," 10 minutos por atributo + 1 hora m\xe9todo de cria\xe7\xe3o de planilha + 30 minutos resource + 1 hora cria\xe7\xe3o teste automatizado"]}),"\n",(0,s.jsx)(a.h2,{id:"etapas-de-execu\xe7\xe3o-cria\xe7\xe3o",children:"Etapas de execu\xe7\xe3o cria\xe7\xe3o"}),"\n",(0,s.jsx)(a.h3,{id:"anota\xe7\xf5es",children:"Anota\xe7\xf5es"}),"\n",(0,s.jsxs)(a.p,{children:["O sgpp-services fornece uma biblioteca de transforma\xe7\xe3o de objetos POJO para planilhas do Excel. Para tanto deve-se utilizar a seguinte anota\xe7\xe3o nos atributos da classe POJO ",(0,s.jsx)(a.em,{children:"sgpp.fileprocessor.annotations.RelacionamentoPlanilhaCriacao"}),(0,s.jsx)(a.br,{}),"\n","Cada um desses atributos deve receber a coluna a qual o atributo ser\xe1 aplicado na planilha excel, adicionalmente pode-se adicionar o nome da  coluna (cabe\xe7alho) na qual o atributo ser\xe1 aplicado. e.g"]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-javascript",children:'@RelacionamentoPlanilhaCriacao(coluna="A", nomeCabecalho = "Contrato CPP")\r\nprivate String contratoCpp;\n'})}),"\n",(0,s.jsxs)(a.p,{children:["\ud83d\udca1 Essa anota\xe7\xe3o tamb\xe9m pode ser aplicada em m\xe9todos acessores do tipo  ",(0,s.jsx)(a.em,{children:"get."})," Em vers\xf5es anteriores dessa biblioteca, essa era a \xfanica forma de aplicar essa anota\xe7\xe3o"]}),"\n",(0,s.jsx)(a.h3,{id:"m\xe9todo-de-cria\xe7\xe3o-de-planilha",children:"M\xe9todo de cria\xe7\xe3o de planilha"}),"\n",(0,s.jsxs)(a.p,{children:["Para cria\xe7\xe3o do m\xe9todo de cria\xe7\xe3o de planilha, deve-se utilizar o servi\xe7o fornecido pela seguinte classe:",(0,s.jsx)(a.br,{}),"\n","-",(0,s.jsx)(a.em,{children:"sgpp.fileprocessor.service.XlsCreatorService"}),(0,s.jsx)(a.br,{}),"\n","O tipo gen\xe9rio ",(0,s.jsx)(a.em,{children:"T"})," se refere \xe0 classe anotada com o atributo ",(0,s.jsx)(a.em,{children:"RelacionamentoPlanilhaCriacao"}),"\r\nDeve-se usar o seguinte m\xe9todo para cria\xe7\xe3o da planilha: ",(0,s.jsx)(a.em,{children:"sgpp.fileprocessor.service.XlsCreatorService.criar(T)"}),(0,s.jsx)(a.br,{}),"\n","Como par\xe2metro deve-se passar o objeto que representa a linha que ser\xe1  aplicada na planilha e.g"]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-javascript",children:'ListaBallotEntity lista = listas.get(0);\r\nXlsCreatorService<ListaBallotEntity> creatorService = new XlsCreatorService<>();\r\nreturn creatorService\r\n        .cabecalho(true)\r\n        .nomePlanilha(NOME_PLANILHA)\r\n        .transformarCelula(new BigDecimalValueTransformation(Double.class), "K")\r\n        .transformarCelula(new BigDecimalValueTransformation(Double.class), "L")\r\n        .transformarCelula(new BigDecimalValueTransformation(Double.class), "M")\r\n        .ajustarColunas(true)\r\n        .criar(lista);\n'})}),"\n",(0,s.jsxs)(a.p,{children:["\ud83d\udca1 Objetos de transforma\xe7\xe3o de dados poder\xe3o ser aplicados como observado no exemplo. Vide o elemento de constru\xe7\xe3o ",(0,s.jsx)(a.em,{children:"Transformando atributos de uma planilha durante sua cria\xe7\xe3o"}),(0,s.jsx)(a.br,{}),"\n","\xc9 poss\xedvel receber a planilha em formato base64, utilizando o seguinte  m\xe9todo ",(0,s.jsx)(a.em,{children:"sgpp.fileprocessor.service.XlsCreatorService.getBase64Workbook()"})," e.g."]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-javascript",children:'XlsCreatorService<PlanilhaRemessa> remessaCreatorService = new XlsCreatorService<>();    \t\r\nString xlsBase64 = remessaCreatorService\r\n        .cabecalho(true)\r\n        .nomePlanilha("LG")\r\n        .transformarCelula(new BooleanToStringValueTransformation(String.class), "AF")\r\n        .criar(planilhaRemessa)\r\n        .getBase64Workbook();\n'})}),"\n",(0,s.jsx)(a.h2,{id:"teste-automatizado",children:"Teste automatizado"}),"\n",(0,s.jsxs)(a.p,{children:["O teste automatizado da cria\xe7\xe3o de uma planilha, exige que um m\xe9todo que extra\xe7\xe3o da planilha seja criado, para tanto observe o elemento de  constru\xe7\xe3o ",(0,s.jsx)(a.em,{children:"Extra\xe7\xe3o de planilha em classe java"}),(0,s.jsx)(a.br,{}),"\n","O teste automatizado dever\xe1 ser composto de 3 etapas:"]}),"\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsx)(a.li,{children:"Defini\xe7\xe3o do objeto mock a partir da classe anotada"}),"\n",(0,s.jsx)(a.li,{children:"Chamada do servi\xe7o a ser testado"}),"\n",(0,s.jsx)(a.li,{children:"Receber a planilha em formato base64"}),"\n",(0,s.jsx)(a.li,{children:"Chamada do servi\xe7o de extra\xe7\xe3o de planilha equivalente e armazenamento do resultado em um objeto equivalente"}),"\n",(0,s.jsx)(a.li,{children:"Compara\xe7\xe3o dos campos do mock e da classe gerada"}),"\n"]})]})}function p(e={}){const{wrapper:a}={...(0,i.R)(),...e.components};return a?(0,s.jsx)(a,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,a,o)=>{o.d(a,{R:()=>n,x:()=>t});var r=o(6540);const s={},i=r.createContext(s);function n(e){const a=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function t(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:n(e.components),r.createElement(i.Provider,{value:a},e.children)}}}]);