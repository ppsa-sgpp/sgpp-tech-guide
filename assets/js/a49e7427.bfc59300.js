"use strict";(self.webpackChunksgpp_tech_guide=self.webpackChunksgpp_tech_guide||[]).push([[9230],{7387:(e,a,s)=>{s.r(a),s.d(a,{assets:()=>r,contentTitle:()=>n,default:()=>p,frontMatter:()=>d,metadata:()=>o,toc:()=>t});const o=JSON.parse('{"id":"building-blocks/sgpp-services/ciclo-vida","title":"Cria\xe7\xe3o de Etapas do Ciclo de Vida de Contas de Custo em \xd3leo","description":"\ud83d\udd0d\ufe0f Local de cria\xe7\xe3o: sgpp-services","source":"@site/docs/building-blocks/sgpp-services/ciclo-vida.md","sourceDirName":"building-blocks/sgpp-services","slug":"/building-blocks/sgpp-services/ciclo-vida","permalink":"/sgpp-tech-guide/docs/building-blocks/sgpp-services/ciclo-vida","draft":false,"unlisted":false,"editUrl":"https://github.com/ppsa-sgpp/sgpp-tech-guide/edit/main/docs/building-blocks/sgpp-services/ciclo-vida.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"TKTEMPL_SgppTemplates (TKTEMPL)","permalink":"/sgpp-tech-guide/docs/building-blocks/ibm-baw/toolkit-de-templates"},"next":{"title":"Cria\xe7\xe3o de planilha a partir de classe POJO","permalink":"/sgpp-tech-guide/docs/building-blocks/sgpp-services/servico_criacao_planilha_classe"}}');var i=s(4848),c=s(8453);const d={},n="Cria\xe7\xe3o de Etapas do Ciclo de Vida de Contas de Custo em \xd3leo",r={},t=[{value:"Etapas de Execu\xe7\xe3o",id:"etapas-de-execu\xe7\xe3o",level:2},{value:"1. Criar Classe de API REST",id:"1-criar-classe-de-api-rest",level:3},{value:"2. Criar Classe de Requisi\xe7\xe3o (Input de Dados) da Etapa",id:"2-criar-classe-de-requisi\xe7\xe3o-input-de-dados-da-etapa",level:3},{value:"2.1. Definir o atributo como v\xednculo",id:"21-definir-o-atributo-como-v\xednculo",level:4},{value:"3. Criar Classe da Etapa",id:"3-criar-classe-da-etapa",level:3},{value:"3.1. Definir o M\xe9todo <code>executar</code> da Etapa",id:"31-definir-o-m\xe9todo-executar-da-etapa",level:4},{value:"4. Atualizar a Cria\xe7\xe3o do Ciclo de Vida de Contas de Custo em \xd3leo",id:"4-atualizar-a-cria\xe7\xe3o-do-ciclo-de-vida-de-contas-de-custo-em-\xf3leo",level:3},{value:"5. Atualizar o Diagrama do Estado Atual do Ciclo de Vida de Contas de Custo em \xd3leo",id:"5-atualizar-o-diagrama-do-estado-atual-do-ciclo-de-vida-de-contas-de-custo-em-\xf3leo",level:3}];function l(e){const a={a:"a",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.header,{children:(0,i.jsx)(a.h1,{id:"cria\xe7\xe3o-de-etapas-do-ciclo-de-vida-de-contas-de-custo-em-\xf3leo",children:"Cria\xe7\xe3o de Etapas do Ciclo de Vida de Contas de Custo em \xd3leo"})}),"\n",(0,i.jsxs)(a.p,{children:["\ud83d\udd0d\ufe0f ",(0,i.jsx)(a.strong,{children:"Local de cria\xe7\xe3o:"})," ",(0,i.jsx)(a.code,{children:"sgpp-services"}),(0,i.jsx)(a.br,{}),"\n","\u231b\ufe0f ",(0,i.jsx)(a.strong,{children:"Tempo estimado:"})," 8 horas + tempo para desenvolver regra de neg\xf3cio + tempo para desenvolver teste unit\xe1rio da regra de neg\xf3cio"]}),"\n",(0,i.jsx)(a.hr,{}),"\n",(0,i.jsx)(a.h2,{id:"etapas-de-execu\xe7\xe3o",children:"Etapas de Execu\xe7\xe3o"}),"\n",(0,i.jsx)(a.h3,{id:"1-criar-classe-de-api-rest",children:"1. Criar Classe de API REST"}),"\n",(0,i.jsxs)(a.p,{children:["\ud83d\udce6\ufe0f ",(0,i.jsx)(a.strong,{children:"Pacote:"})," ",(0,i.jsx)(a.code,{children:"sgpp.services.web.rest"}),(0,i.jsx)(a.br,{}),"\n","\ud83c\udff7\ufe0f ",(0,i.jsx)(a.strong,{children:"Nome:"})," Deve refletir o nome da etapa, iniciando com ",(0,i.jsx)(a.code,{children:"Etapa"})," e terminando com ",(0,i.jsx)(a.code,{children:"Resource"}),".",(0,i.jsx)(a.br,{}),"\n","\ud83d\udcc4 ",(0,i.jsx)(a.strong,{children:"Descri\xe7\xe3o:"})," Classe que exp\xf5e a etapa do ciclo de vida como API REST. Deve possuir apenas um m\xe9todo com a seguinte assinatura:"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-java",children:"sgpp.services.web.rest.EtapaAdicaoOverheadContaCustoOleoResource.executar(...)\n"})}),"\n",(0,i.jsx)(a.p,{children:"\ud83d\udd39 Esse m\xe9todo deve:"}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsx)(a.li,{children:"Receber todos os par\xe2metros necess\xe1rios para a composi\xe7\xe3o do input da etapa."}),"\n",(0,i.jsxs)(a.li,{children:["Instanciar a classe de ",(0,i.jsx)(a.em,{children:"Requisi\xe7\xe3o"}),"."]}),"\n",(0,i.jsx)(a.li,{children:"Buscar na base os dados necess\xe1rios para popular essa classe."}),"\n",(0,i.jsxs)(a.li,{children:["Utilizar o m\xe9todo:","\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-java",children:"sgpp.services.service.EventStoreClient.addEtapa(EtapaBaseEvent)\n"})}),"\n","para adicionar a etapa na fila de execu\xe7\xe3o."]}),"\n"]}),"\n",(0,i.jsxs)(a.p,{children:["\ud83d\udca1 ",(0,i.jsx)(a.strong,{children:"Dica:"})," Fa\xe7a com que os par\xe2metros do m\xe9todo ",(0,i.jsx)(a.code,{children:"executar"})," sejam o mais resumidos poss\xedveis. O estado da aplica\xe7\xe3o pode ser consultado na base de dados, ent\xe3o, sempre que poss\xedvel, utilize identificadores como inputs."]}),"\n",(0,i.jsx)(a.hr,{}),"\n",(0,i.jsx)(a.h3,{id:"2-criar-classe-de-requisi\xe7\xe3o-input-de-dados-da-etapa",children:"2. Criar Classe de Requisi\xe7\xe3o (Input de Dados) da Etapa"}),"\n",(0,i.jsxs)(a.p,{children:["\ud83d\udce6\ufe0f ",(0,i.jsx)(a.strong,{children:"Pacote:"})," ",(0,i.jsx)(a.code,{children:"sgpp.ciclovidacco.etapas.[NomeDaEtapaCamelCase].[NumeroVersao]"}),(0,i.jsx)(a.br,{}),"\n","\ud83c\udff7\ufe0f ",(0,i.jsx)(a.strong,{children:"Nome:"})," Deve refletir o nome da etapa, iniciando com ",(0,i.jsx)(a.code,{children:"Etapa"})," e terminando com ",(0,i.jsx)(a.code,{children:"Requisicao"}),".",(0,i.jsx)(a.br,{}),"\n","\ud83d\udce4\ufe0f ",(0,i.jsx)(a.strong,{children:"Ascend\xeancia:"})," Deve estender ",(0,i.jsx)(a.code,{children:"sgpp.ciclovidacco.etapas.EtapaRequisicao"}),".",(0,i.jsx)(a.br,{}),"\n","#\ufe0f\u20e3 ",(0,i.jsx)(a.strong,{children:"Anota\xe7\xf5es:"})," Deve conter as anota\xe7\xf5es:"]}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsx)(a.li,{children:(0,i.jsx)(a.code,{children:"@lombok.Data"})}),"\n",(0,i.jsx)(a.li,{children:(0,i.jsx)(a.code,{children:"@lombok.EqualsAndHashCode(callSuper = false)"})}),"\n",(0,i.jsx)(a.li,{children:(0,i.jsx)(a.code,{children:"@lombok.ToString"})}),"\n"]}),"\n",(0,i.jsxs)(a.p,{children:["\ud83d\udcc4 ",(0,i.jsx)(a.strong,{children:"Descri\xe7\xe3o:"})," Esta classe representa um ",(0,i.jsx)(a.em,{children:"Value Object"})," contendo todo o estado da regra de neg\xf3cio modelada na etapa. Durante a execu\xe7\xe3o da etapa, o estado da aplica\xe7\xe3o n\xe3o deve ser consultado na base (com algumas exce\xe7\xf5es). Todos os objetos de valor devem ser atributos dessa classe."]}),"\n",(0,i.jsxs)(a.p,{children:["\u25b6\ufe0f ",(0,i.jsx)(a.strong,{children:"M\xe9todos:"})," Deve conter um m\xe9todo de cria\xe7\xe3o com a seguinte assinatura:"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-java",children:"public static [NomeDaClasse] criarEtapa(...)\n"})}),"\n",(0,i.jsx)(a.h4,{id:"21-definir-o-atributo-como-v\xednculo",children:"2.1. Definir o atributo como v\xednculo"}),"\n",(0,i.jsxs)(a.p,{children:["\ud83d\udcc4 ",(0,i.jsx)(a.strong,{children:"Descri\xe7\xe3o:"})," Como o ciclo de vida tem a caracter\xedstica de ser reexecutado, \xe9 necess\xe1rio definir um atributo que carrega as altera\xe7\xf5es realizadas pela etapa anterior. Para tanto, \xe9 necess\xe1rio identificar esse atributo (que na maior parte das vezes \xe9 ou RemessaEntity ou ContaCustoOleoEntity).\nPara realizar esa identifica\xe7\xe3o, a seguinte anota\xe7\xe3o deve ser adicionada \xe0 esse atributo"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{children:'@EtapaPreviaVinculo(value = "...", nomeItem = "...")\n'})}),"\n",(0,i.jsxs)(a.p,{children:["Como ",(0,i.jsx)(a.code,{children:"value"}),"deve ser passado o FQN da classe enquanto ",(0,i.jsx)(a.code,{children:"nomeItem"})," deve ser passado o nome do atributo conforme ele \xe9 na etapa anterior"]}),"\n",(0,i.jsx)(a.hr,{}),"\n",(0,i.jsx)(a.h3,{id:"3-criar-classe-da-etapa",children:"3. Criar Classe da Etapa"}),"\n",(0,i.jsxs)(a.p,{children:["\ud83d\udce6\ufe0f ",(0,i.jsx)(a.strong,{children:"Pacote:"})," ",(0,i.jsx)(a.code,{children:"sgpp.ciclovidacco.etapas.[NomeDaEtapaCamelCase].[NumeroVersao]"}),(0,i.jsx)(a.br,{}),"\n","\ud83c\udff7\ufe0f ",(0,i.jsx)(a.strong,{children:"Nome:"})," Deve refletir o nome da etapa.",(0,i.jsx)(a.br,{}),"\n","\ud83d\udce4\ufe0f ",(0,i.jsx)(a.strong,{children:"Ascend\xeancia:"})," Deve estender ",(0,i.jsx)(a.code,{children:"sgpp.ciclovidacco.etapas.EtapaImpl"}),".",(0,i.jsx)(a.br,{}),"\n","\ud83d\udcc4 ",(0,i.jsx)(a.strong,{children:"Descri\xe7\xe3o:"})," Classe que cont\xe9m a regra de neg\xf3cio e deve obedecer \xe0s seguintes diretrizes:"]}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Idempot\xeancia:"})," Execu\xe7\xf5es consecutivas devem sempre alterar o estado da mesma forma, ou seja, sem efeitos colaterais indesejados."]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Isolamento do Estado:"})," N\xe3o deve consultar o estado da aplica\xe7\xe3o diretamente. Todos os dados devem vir da classe ",(0,i.jsx)(a.em,{children:"Requisicao"}),"."]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Tratamento de Exce\xe7\xf5es:"})," Toda execu\xe7\xe3o deve ser encapsulada em um ",(0,i.jsx)(a.code,{children:"try-catch"})," para capturar ",(0,i.jsx)(a.code,{children:"java.lang.Exception"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(a.p,{children:["\u25b6\ufe0f ",(0,i.jsx)(a.strong,{children:"M\xe9todos:"})," Deve conter apenas um m\xe9todo p\xfablico com a seguinte assinatura:"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-java",children:"public void executar(EtapaRequisicaoImpl etapaRequisicao)\n"})}),"\n",(0,i.jsxs)(a.h4,{id:"31-definir-o-m\xe9todo-executar-da-etapa",children:["3.1. Definir o M\xe9todo ",(0,i.jsx)(a.code,{children:"executar"})," da Etapa"]}),"\n",(0,i.jsxs)(a.p,{children:["\ud83d\udcc4 ",(0,i.jsx)(a.strong,{children:"Descri\xe7\xe3o:"})," O m\xe9todo ",(0,i.jsx)(a.code,{children:"executar"})," deve chamar os seguintes m\xe9todos:"]}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsxs)(a.li,{children:["\n",(0,i.jsx)(a.p,{children:(0,i.jsx)(a.strong,{children:"Altera\xe7\xe3o de Estado:"})}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-java",children:"sgpp.services.service.EventoPendenteService.addEvent(BaseEvent, EtapaRequisicao)\n"})}),"\n"]}),"\n",(0,i.jsxs)(a.li,{children:["\n",(0,i.jsx)(a.p,{children:(0,i.jsx)(a.strong,{children:"Tratamento de Exce\xe7\xe3o:"})}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-java",children:"sgpp.ciclovidacco.etapas.EtapaImpl.lancarExcecaoConclusaoEtapa(CicloVidaCcoService, EtapaRequisicaoImpl, Exception)\n"})}),"\n"]}),"\n",(0,i.jsxs)(a.li,{children:["\n",(0,i.jsx)(a.p,{children:(0,i.jsx)(a.strong,{children:"Finaliza\xe7\xe3o da Etapa:"})}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-java",children:"sgpp.services.contacustooleo.ciclovida.CicloVidaCcoService.concluirEtapa(EtapaBaseEvent)\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(a.hr,{}),"\n",(0,i.jsx)(a.h3,{id:"4-atualizar-a-cria\xe7\xe3o-do-ciclo-de-vida-de-contas-de-custo-em-\xf3leo",children:"4. Atualizar a Cria\xe7\xe3o do Ciclo de Vida de Contas de Custo em \xd3leo"}),"\n",(0,i.jsxs)(a.p,{children:["\u25b6\ufe0f ",(0,i.jsx)(a.strong,{children:"M\xe9todos:"})," Modificar o m\xe9todo:"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-java",children:"sgpp.services.contacustooleo.ciclovida.CicloVidaCcoService.createCicloVidaDefault(FaseRemessaEnum, String, boolean iniciadoEmFaseRecursiva)\n"})}),"\n",(0,i.jsx)(a.p,{children:"\ud83d\udd39 Esse m\xe9todo deve considerar em qual processo a etapa ser\xe1 ativada e utilizar:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-java",children:"sgpp.services.contacustooleo.ciclovida.CicloVidaCcoEntity.adicionarEtapaNoFim(CicloVidaCcoEtapaEnum, CicloVidaCcoEtapaVersaoLogicaEnum, CicloVidaCcoEtapaVersaoRequisicaoEnum)\n"})}),"\n",(0,i.jsx)(a.p,{children:"\ud83d\udd39 Criar um item correspondente na enumera\xe7\xe3o:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-java",children:"sgpp.services.contacustooleo.ciclovida.CicloVidaCcoEtapaEnum\n"})}),"\n",(0,i.jsx)(a.p,{children:"para representar a nova etapa."}),"\n",(0,i.jsx)(a.hr,{}),"\n",(0,i.jsx)(a.h3,{id:"5-atualizar-o-diagrama-do-estado-atual-do-ciclo-de-vida-de-contas-de-custo-em-\xf3leo",children:"5. Atualizar o Diagrama do Estado Atual do Ciclo de Vida de Contas de Custo em \xd3leo"}),"\n",(0,i.jsxs)(a.p,{children:["\ud83d\udcc4 ",(0,i.jsx)(a.strong,{children:"Descri\xe7\xe3o:"})," Atualizar o ",(0,i.jsx)(a.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(2101).A+"",children:"diagrama do ciclo de vida"})," e substituir a imagem abaixo:"]}),"\n",(0,i.jsx)(a.p,{children:(0,i.jsx)(a.img,{alt:"Etapas",src:s(2963).A+"",width:"1639",height:"1336"})})]})}function p(e={}){const{wrapper:a}={...(0,c.R)(),...e.components};return a?(0,i.jsx)(a,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},2101:(e,a,s)=>{s.d(a,{A:()=>o});const o=s.p+"assets/files/etapas_ciclo_vida-7c2463ac7f7da0c283eaa5e1cafe82e8.drawio"},2963:(e,a,s)=>{s.d(a,{A:()=>o});const o=s.p+"assets/images/etapas_ciclo_vida_v4-0ea858a07ee38dfa15c0333a070aac6d.png"},8453:(e,a,s)=>{s.d(a,{R:()=>d,x:()=>n});var o=s(6540);const i={},c=o.createContext(i);function d(e){const a=o.useContext(c);return o.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function n(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),o.createElement(c.Provider,{value:a},e.children)}}}]);